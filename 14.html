<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elf-o-Matic 3000</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel (to translate JSX in the browser) -->
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <!-- Custom Styles -->
    <style>
        @keyframes fall {
            0% { transform: translateY(-10%) rotate(0deg); opacity: 0; }
            10% { opacity: 0.8; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }
        @keyframes pulse-slow {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(0.95); }
        }
        .animate-fall {
            animation-name: fall;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
        }
        .animate-pulse-slow {
            animation: pulse-slow 3s infinite ease-in-out;
        }
        .animate-fade-in-up {
            animation: fadeInUp 0.5s ease-out forwards;
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-[#022043]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICONS (Inline for portability) ---
        const IconBase = ({ children, className }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width="24" 
                height="24" 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {children}
            </svg>
        );

        const Gift = (props) => <IconBase {...props}><rect x="3" y="8" width="18" height="4" rx="1"/><path d="M12 8v13"/><path d="M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"/><path d="M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5"/></IconBase>;
        const ArrowRight = (props) => <IconBase {...props}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></IconBase>;
        const RefreshCw = (props) => <IconBase {...props}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></IconBase>;
        const Star = (props) => <IconBase {...props}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></IconBase>;
        const Heart = (props) => <IconBase {...props}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></IconBase>;
        const Coffee = (props) => <IconBase {...props}><path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" x2="6" y1="2" y2="4"/><line x1="10" x2="10" y1="2" y2="4"/><line x1="14" x2="14" y1="2" y2="4"/></IconBase>;
        const Smartphone = (props) => <IconBase {...props}><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></IconBase>;
        const Music = (props) => <IconBase {...props}><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></IconBase>;
        const Zap = (props) => <IconBase {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></IconBase>;
        const Smile = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" x2="9.01" y1="9" y2="9"/><line x1="15" x2="15.01" y1="9" y2="9"/></IconBase>;

        // --- DATA ---
        const GIFT_DATA = {
            start: {
                id: 'start',
                question: "Ho Ho Ho! Welcome to the Elf-o-Matic 3000.",
                subtext: "Let's find the perfect gift. First things first...",
                options: [
                    { label: "Let's Get Started!", next: 'recipient' }
                ]
            },
            recipient: {
                id: 'recipient',
                question: "Who is the lucky recipient?",
                subtext: "We need to calibrate the sleigh's GPS.",
                options: [
                    { label: "My Partner (The Lovebird)", next: 'partner_vibe' },
                    { label: "My Mom/Dad (The Parental Unit)", next: 'parent_vibe' },
                    { label: "My Best Friend (The Accomplice)", next: 'friend_vibe' },
                    { label: "A Kid (The Chaos Engine)", next: 'kid_vibe' },
                ]
            },
            // Partner
            partner_vibe: {
                question: "What's the current vibe of your relationship?",
                subtext: "Be honest, Santa is watching.",
                options: [
                    { label: "Deeply Romantic & Mushy", next: 'partner_romantic_1' },
                    { label: "Fun, Chill & Practical", next: 'partner_fun_1' }
                ]
            },
            partner_romantic_1: {
                question: "If you were stuck in a snowstorm, what would they do?",
                options: [
                    { label: "Build a fire and cuddle", next: 'flavor_naughty_nice' },
                    { label: "Panic and check their phone", next: 'flavor_naughty_nice' }
                ], 
                meta: { category: 'romantic' } 
            },
            partner_fun_1: {
                question: "What is their ideal Friday night?",
                options: [
                    { label: "Takeout & Netflix", next: 'flavor_naughty_nice' },
                    { label: "Out on the town!", next: 'flavor_naughty_nice' }
                ],
                meta: { category: 'practical' }
            },
            // Parent
            parent_vibe: {
                question: "How difficult are they to shop for?",
                subtext: "On a scale of 1 to 'I don't need anything'.",
                options: [
                    { label: "Impossible. They buy everything.", next: 'parent_hard_1' },
                    { label: "Easy! They love gadgets.", next: 'parent_tech_1' }
                ]
            },
            parent_hard_1: {
                question: "Do they prefer experiences or objects?",
                options: [
                    { label: "Memories over things", next: 'flavor_naughty_nice' },
                    { label: "Something to unwrap", next: 'flavor_naughty_nice' }
                ],
                meta: { category: 'sentimental' }
            },
            parent_tech_1: {
                question: "Are they tech-savvy or just tech-curious?",
                options: [
                    { label: "They code for fun", next: 'flavor_naughty_nice' },
                    { label: "They still double-click links", next: 'flavor_naughty_nice' }
                ],
                meta: { category: 'home' }
            },
            // Friend
            friend_vibe: {
                question: "Describe your friendship aesthetic.",
                options: [
                    { label: "Partners in Crime (Party)", next: 'friend_party_1' },
                    { label: "Coffee & Existential Dread", next: 'friend_cozy_1' }
                ]
            },
            friend_party_1: {
                question: "What's their poison of choice?",
                options: [
                    { label: "Caffeine or Cocktails", next: 'flavor_naughty_nice' },
                    { label: "Adrenaline & Adventure", next: 'flavor_naughty_nice' }
                ],
                meta: { category: 'fun' }
            },
            friend_cozy_1: {
                question: "What's their stress level right now?",
                options: [
                    { label: "High (Needs Chill)", next: 'flavor_naughty_nice' },
                    { label: "Normal (Needs Fun)", next: 'flavor_naughty_nice' }
                ],
                meta: { category: 'relax' }
            },
            // Kid
            kid_vibe: {
                question: "What is the age range?",
                options: [
                    { label: "Tiny Tot (0-5)", next: 'kid_young_1' },
                    { label: "Cool Kid / Teen (6+)", next: 'kid_old_1' }
                ]
            },
            kid_young_1: {
                question: "Are we aiming for loud or quiet?",
                options: [
                    { label: "LOUD NOISES!", next: 'flavor_naughty_nice' },
                    { label: "Please, silence...", next: 'flavor_naughty_nice' }
                ],
                meta: { category: 'kids' }
            },
            kid_old_1: {
                question: "Screen time status?",
                options: [
                    { label: "Glued to the iPad", next: 'flavor_naughty_nice' },
                    { label: "Needs fresh air", next: 'flavor_naughty_nice' }
                ],
                meta: { category: 'kids_older' }
            },
            // Flavor
            flavor_naughty_nice: {
                question: "Checking the Naughty or Nice List...",
                subtext: "Accessing North Pole Servers...",
                options: [
                    { label: "They are an Angel üòá", next: 'flavor_reindeer' },
                    { label: "A little Naughty üòà", next: 'flavor_reindeer' }
                ]
            },
            flavor_reindeer: {
                question: "If they were a reindeer, which one would they be?",
                options: [
                    { label: "Rudolph (The Leader)", next: 'flavor_snow' },
                    { label: "Blitzen (The Party Animal)", next: 'flavor_snow' },
                    { label: "Comet (The Space Cadet)", next: 'flavor_snow' }
                ]
            },
            flavor_snow: {
                question: "It's snowing! Quick, what do they grab?",
                options: [
                    { label: "Hot Cocoa", next: 'flavor_music' },
                    { label: "A Shovel", next: 'flavor_music' },
                    { label: "Their Camera", next: 'flavor_music' }
                ]
            },
            flavor_music: {
                question: "What's playing on the speakers?",
                options: [
                    { label: "Mariah Carey (All I Want...)", next: 'flavor_elf' },
                    { label: "Classic Jazz", next: 'flavor_elf' },
                    { label: "Total Silence", next: 'flavor_elf' }
                ]
            },
            flavor_elf: {
                question: "An Elf asks for help wrapping. They...",
                options: [
                    { label: "Wrap it perfectly with a bow", next: 'final_check' },
                    { label: "Use duct tape and hope", next: 'final_check' }
                ]
            },
            final_check: {
                question: "Final Calculation initiated.",
                subtext: "Are you ready to see the result?",
                options: [
                    { label: "Show me the gift!", next: 'RESULT' }
                ]
            }
        };

        const calculateResult = (history) => {
            const path = history.map(h => h.id);
            let gift = {
                title: "A Classic Gift Card",
                desc: "When in doubt, let them choose! But put it in a really, really nice box.",
                icon: <Gift className="w-16 h-16 text-amber-500" />
            };

            if (path.includes('partner_romantic_1')) {
                gift = { title: "A Custom Star Map", desc: "A framed map of the stars from the night you met. Incredibly cheesy? Yes. Will they cry happy tears? Also yes.", icon: <Star className="w-16 h-16 text-amber-400" /> };
            } else if (path.includes('partner_fun_1')) {
                gift = { title: "An Experience Box", desc: "Tickets to a comedy show, a cooking class, or an escape room. Something you do together that doesn't clutter the house!", icon: <Zap className="w-16 h-16 text-orange-500" /> };
            } else if (path.includes('parent_hard_1')) {
                gift = { title: "Digital Photo Frame", desc: "Pre-load it with photos of the family (and you, mostly you). It's the gift that keeps on giving every time they walk past it.", icon: <Heart className="w-16 h-16 text-rose-400" /> };
            } else if (path.includes('parent_tech_1')) {
                gift = { title: "Smart Home Assistant (with Setup)", desc: "Buy the gadget, but the REAL gift is the coupon for '2 hours of tech support from you' to actually set it up properly.", icon: <Smartphone className="w-16 h-16 text-indigo-500" /> };
            } else if (path.includes('friend_party_1')) {
                gift = { title: "DIY Cocktail/Mocktail Kit", desc: "Fancy bitters, a shaker, and a recipe book. Or just a really nice bottle of something specific they love.", icon: <Music className="w-16 h-16 text-purple-500" /> };
            } else if (path.includes('friend_cozy_1')) {
                gift = { title: "The Ultimate Cozy Care Package", desc: "A weighted blanket, a candle that smells like 'Wood Cabin', and gourmet tea. Maximum hibernation mode enabled.", icon: <Coffee className="w-16 h-16 text-amber-700" /> };
            } else if (path.includes('kid_young_1')) {
                gift = { title: "Magnetic Building Tiles", desc: "They are colorful, they click together satisfyingly, and stepping on them hurts significantly less than LEGOs.", icon: <Smile className="w-16 h-16 text-teal-500" /> };
            } else if (path.includes('kid_old_1')) {
                gift = { title: "Instant Print Camera", desc: "Retro cool is back. Give them a camera that prints physical photos immediately. It's like Instagram, but real life!", icon: <Zap className="w-16 h-16 text-indigo-500" /> };
            }
            return gift;
        };

        const Snow = () => {
            return (
                <div className="fixed inset-0 pointer-events-none z-0 overflow-hidden">
                    {[...Array(20)].map((_, i) => (
                        <div 
                            key={i}
                            className="absolute text-white opacity-70 animate-fall"
                            style={{
                                left: `${Math.random() * 100}%`,
                                top: `-${Math.random() * 20}%`,
                                animationDuration: `${Math.random() * 5 + 5}s`,
                                animationDelay: `${Math.random() * 5}s`,
                                fontSize: `${Math.random() * 20 + 10}px`
                            }}
                        >
                        ‚ùÑ
                        </div>
                    ))}
                </div>
            );
        };

        function GiftDecider() {
            const [currentNodeId, setCurrentNodeId] = useState('start');
            const [history, setHistory] = useState([]);
            const [isTransitioning, setIsTransitioning] = useState(false);
            const [result, setResult] = useState(null);

            const currentNode = { ...GIFT_DATA[currentNodeId], id: currentNodeId };
            const progress = Math.min((history.length / 9) * 100, 100);

            const handleOptionClick = (option) => {
                setIsTransitioning(true);
                const newHistory = [...history, currentNode];
                setTimeout(() => {
                    if (option.next === 'RESULT') {
                        const gift = calculateResult(newHistory);
                        setResult(gift);
                    } else {
                        setCurrentNodeId(option.next);
                    }
                    setHistory(newHistory);
                    setIsTransitioning(false);
                }, 400);
            };

            const reset = () => {
                setCurrentNodeId('start');
                setHistory([]);
                setResult(null);
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-4 relative overflow-hidden font-sans">
                    {/* Background Gradients */}
                    <div 
                        className="absolute inset-0 opacity-100" 
                        style={{
                            background: 'linear-gradient(0deg, #FD7E00 0%, #FDA63D 5%, #FECE7A 15%, #FFDBBA 25%, #EEC9DB 35%, #C8A2E1 45%, #8579CF 55%, #0057AE 75%, #022043 95%)'
                        }}
                    />
                    <Snow />

                    <div className="relative z-10 w-full max-w-2xl">
                        {/* Header */}
                        <div className="text-center mb-8">
                            <div className="inline-block bg-white/10 backdrop-blur-md rounded-full p-4 mb-4 border border-white/20 shadow-lg animate-pulse-slow">
                                <Gift className="w-10 h-10 text-amber-300" />
                            </div>
                            <h1 className="text-4xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-amber-200 via-white to-purple-200 drop-shadow-sm font-serif tracking-wide">
                                Elf-o-Matic 3000
                            </h1>
                            <p className="text-indigo-100 mt-2 text-lg italic">The North Pole's premiere decision engine</p>
                        </div>

                        {/* Main Card */}
                        <div className="bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl border-4 border-indigo-300/40 overflow-hidden transform transition-all duration-500 min-h-[400px] flex flex-col relative">
                            {/* Progress Bar */}
                            {!result && currentNodeId !== 'start' && (
                                <div className="h-4 w-full bg-indigo-50 relative">
                                    <div 
                                        className="h-full bg-gradient-to-r from-amber-400 to-orange-500 transition-all duration-700 ease-out border-r-4 border-indigo-200"
                                        style={{ width: `${progress}%` }}
                                    />
                                </div>
                            )}

                            {/* Content Area */}
                            <div className="flex-1 p-8 md:p-12 flex flex-col items-center justify-center text-center">
                                {result ? (
                                    <div className="animate-fade-in-up w-full">
                                        <div className="mb-6 flex justify-center">
                                            <div className="p-6 bg-indigo-50 rounded-full border-4 border-dashed border-indigo-200 shadow-inner">
                                                {result.icon}
                                            </div>
                                        </div>
                                        <h2 className="text-3xl font-bold text-slate-800 mb-2">The Elves Suggest:</h2>
                                        <h3 className="text-2xl md:text-4xl font-extrabold text-indigo-900 mb-6 font-serif">{result.title}</h3>
                                        <div className="bg-indigo-50 p-6 rounded-xl border border-indigo-100 mb-8">
                                            <p className="text-lg text-slate-700 leading-relaxed">{result.desc}</p>
                                        </div>
                                        <button 
                                            onClick={reset}
                                            className="group flex items-center justify-center gap-2 w-full py-4 bg-indigo-900 text-white rounded-xl font-bold hover:bg-indigo-800 transition-all hover:scale-[1.02] shadow-lg"
                                        >
                                            <RefreshCw className="w-5 h-5 group-hover:rotate-180 transition-transform duration-500" />
                                            Start Over
                                        </button>
                                    </div>
                                ) : (
                                    <div className={`w-full transition-opacity duration-300 ${isTransitioning ? 'opacity-0 translate-y-4' : 'opacity-100 translate-y-0'}`}>
                                        {currentNodeId !== 'start' && (
                                            <div className="mb-4 text-xs font-bold tracking-widest text-indigo-500 uppercase">
                                                Step {history.length + 1}
                                            </div>
                                        )}
                                        <h2 className="text-2xl md:text-3xl font-bold text-slate-800 mb-4 font-serif">
                                            {currentNode.question}
                                        </h2>
                                        {currentNode.subtext && (
                                            <p className="text-slate-500 mb-8 text-lg">{currentNode.subtext}</p>
                                        )}
                                        <div className="grid grid-cols-1 gap-4 w-full max-w-md mx-auto">
                                            {currentNode.options.map((opt, idx) => (
                                                <button
                                                    key={idx}
                                                    onClick={() => handleOptionClick(opt)}
                                                    className="group relative overflow-hidden bg-white border-2 border-slate-200 hover:border-amber-400 hover:shadow-amber-100 p-4 md:p-5 rounded-2xl text-left shadow-sm hover:shadow-xl transition-all duration-200 hover:-translate-y-1"
                                                >
                                                    <div className="flex items-center justify-between relative z-10">
                                                        <span className="font-semibold text-slate-700 group-hover:text-amber-700 text-lg">
                                                            {opt.label}
                                                        </span>
                                                        <ArrowRight className="w-5 h-5 text-slate-300 group-hover:text-amber-500 transform group-hover:translate-x-1 transition-transform" />
                                                    </div>
                                                    <div className="absolute inset-0 bg-amber-50 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300 -z-0" />
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                            <div className="h-3 bg-gradient-to-r from-indigo-500 via-purple-500 to-amber-500" />
                        </div>
                        <p className="text-center text-indigo-200 mt-6 text-sm">
                            Built with holiday cheer & React
                        </p>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<GiftDecider />);
    </script>
</body>
</html>